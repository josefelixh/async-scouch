<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Async-scouch by josefelixh</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/josefelixh/async-scouch">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/josefelixh/async-scouch/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/josefelixh/async-scouch/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Async-scouch</h1>
          <p>Asynchronoush non-blocking BigCouch/Cloudant client.</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/josefelixh">josefelixh</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a name="async-scouch" class="anchor" href="#async-scouch"><span class="octicon octicon-link"></span></a>Async-scouch</h1>

<p>Async-scouch is a BigCouch/Cloudant client library. It based on top of netty, ning asynchronous http client and the super cool play-json libraries based on jerkson/jackson. So far is targets scala, but the intention is to make it work for java as well.</p>

<h3>
<a name="usage-scala" class="anchor" href="#usage-scala"><span class="octicon octicon-link"></span></a>Usage (Scala)</h3>

<h5>
<a name="basic-crud-operations" class="anchor" href="#basic-crud-operations"><span class="octicon octicon-link"></span></a>Basic CRUD operations</h5>

<p>First you need some stuff to persist.</p>

<pre><code>case class Role(name: String, permissions: Int)
case class Profile(id: String, level: Int, roles: Seq[Role])

val role = Role("admin", 777)
val profile = Profile("badger", 0, Vector(role))
</code></pre>

<p>Then configure the client</p>

<pre><code>val credentials = Some(("username", "password"))
val couchConfig = CouchConfig("https://couchinstance.com:port", "dbname", credentials)

implicit val executionContext = ExecutionContext.Implicits.global
implicit val couch = Couch(couchConfig)
</code></pre>

<p>Provide a way to serialise/deserialise your objects to json</p>

<pre><code>implicit val roleFormat = Json.format[Role]
implicit val profileFormat = Json.format[Profile]
</code></pre>

<p>Then you can just use CouchDocument to do CRUD operations with your objects. </p>

<pre><code>val future = for {
  createdNoId &lt;- CouchDocument(profile).create
  created &lt;- CouchDocument("PROFILE_ID", profile).create
  docId = Id[Profile](createdNoId.id.get)
  retreived &lt;- docId.retrieve
  updated &lt;- createdNoId.update(current =&gt; current.copy(level = 1))
  updateRetreived &lt;- docId.retrieve
  deleteResponse &lt;- updated.delete
  deleteResponse2 &lt;- created.delete
} yield {
  println(s"CREATED : $createdNoId")
  println(s"CREATED : $created")
  println(s"RETREIVED : $retreived")
  println(s"UPDATED : $updated")
  println(s"RETREIVED : $updateRetreived")
  println(s"DELETED : ${deleteResponse.json}")
  println(s"DELETED : ${deleteResponse2.json}")
}

future.onComplete { 
  case Success(x) =&gt; println("Easy!!!")
  case Failure(t) =&gt; println("An error has occured: " + t.getMessage)
}
</code></pre>

<p>In order to see some results it is needed to wait for the future, but this is something you might not want to do in your application.</p>

<pre><code>Await.result(future, 10 seconds)
</code></pre>

<h2>
<a name="licence" class="anchor" href="#licence"><span class="octicon octicon-link"></span></a>Licence</h2>

<p>This software is licensed under the Apache 2 license, quoted below.</p>

<p>Copyright 2013 josefelixh (<a href="http://github.com/josefelixh">http://github.com/josefelixh</a>).</p>

<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this project except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>

<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>